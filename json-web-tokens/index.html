<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-json-web-tokens" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.1.0">
<title data-rh="true">JWT(JSON Web Token)介紹 | My Site</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://sueraychang.github.io/src.dev/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://sueraychang.github.io/src.dev/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="https://sueraychang.github.io/src.dev/json-web-tokens"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="JWT(JSON Web Token)介紹 | My Site"><meta data-rh="true" name="description" content="什麼是 JSON Web Token?"><meta data-rh="true" property="og:description" content="什麼是 JSON Web Token?"><link data-rh="true" rel="icon" href="/src.dev/img/favicon-src.ico"><link data-rh="true" rel="canonical" href="https://sueraychang.github.io/src.dev/json-web-tokens"><link data-rh="true" rel="alternate" href="https://sueraychang.github.io/src.dev/json-web-tokens" hreflang="en"><link data-rh="true" rel="alternate" href="https://sueraychang.github.io/src.dev/json-web-tokens" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/src.dev/blog/rss.xml" title="My Site RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/src.dev/blog/atom.xml" title="My Site Atom Feed">

<link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-4CCS3TY6BJ"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-4CCS3TY6BJ",{anonymize_ip:!0})</script><link rel="stylesheet" href="/src.dev/assets/css/styles.6037c4f1.css">
<script src="/src.dev/assets/js/runtime~main.1290b711.js" defer="defer"></script>
<script src="/src.dev/assets/js/main.823109e8.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/src.dev/"><div class="navbar__logo"><img src="/src.dev/img/logo-src.svg" alt="My Site Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/src.dev/img/logo-src.svg" alt="My Site Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">src.dev</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/src.dev/category/docusaurus">Docs</a><a class="navbar__item navbar__link" href="/src.dev/blog">Blog</a></div><div class="navbar__items navbar__items--right"><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/src.dev/category/docusaurus">Docusaurus</a><button aria-label="Expand sidebar category &#x27;Docusaurus&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/src.dev/category/kotlin">Kotlin</a><button aria-label="Expand sidebar category &#x27;Kotlin&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" href="/src.dev/json-web-tokens">JWT(JSON Web Token)介紹</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/src.dev/session-and-cookie">Session 跟 Cookie</a></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/src.dev/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">JWT(JSON Web Token)介紹</span><meta itemprop="position" content="1"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>JWT(JSON Web Token)介紹</h1></header><h2 class="anchor anchorWithStickyNavbar_LWe7" id="什麼是-json-web-token">什麼是 JSON Web Token?<a href="#什麼是-json-web-token" class="hash-link" aria-label="Direct link to 什麼是 JSON Web Token?" title="Direct link to 什麼是 JSON Web Token?">​</a></h2>
<p>JSON Web Token (JWT) 是一個公認的開放標準 <a href="https://datatracker.ietf.org/doc/html/rfc7519" target="_blank" rel="noopener noreferrer">RFC 7519</a>，它以一種簡潔且自足的方式定義了如何安全地在各方之間傳遞資訊，這些資訊以 JSON 格式表達。由於這些資訊經過數位簽名，因此可以進行驗證並被信任。JWTs 可以透過 HMAC 算法和密鑰進行簽名，或者使用 RSA 或 ECDSA 的公私鑰技術簽名。</p>
<p>儘管 JWTs 也可以進行加密，以保護資訊間的隱私，但我們這裡主要討論的是簽名機制。透過簽名的 JWTs 能夠確認其中包含的聲明是完整無誤的，而加密的 JWTs 則能對其他方隱藏這些聲明。當 JWTs 使用公私鑰對進行簽名時，該簽名還證明了只有持有私鑰的人才是真正的簽名者。</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="你在何時需要使用-jwt">你在何時需要使用 JWT?<a href="#你在何時需要使用-jwt" class="hash-link" aria-label="Direct link to 你在何時需要使用 JWT?" title="Direct link to 你在何時需要使用 JWT?">​</a></h2>
<ul>
<li>
<p>授權(Authorization)：JWT 最常用於授權場景。用戶一旦登入，他們的每一次請求都會攜帶 JWT，這使得用戶能夠訪問他們用該 Token 獲得權限的路徑、服務及資源。現今，單一登入功能廣泛採用了 JWT，原因在於它的輕量性和易於跨不同領域使用的特點。</p>
</li>
<li>
<p>資訊交換：JTWs 是一種在各方之間安全交換資訊的有效方式。由於 JWT 可以進行簽名，比如使用公私鑰對，因此你可以確定發送者的身份無誤。此外，由於簽名是基於標頭和有效內容計算的，這也意味著你能夠確認傳輸的內容沒有被篡改。</p>
</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="jwt-的結構">JWT 的結構<a href="#jwt-的結構" class="hash-link" aria-label="Direct link to JWT 的結構" title="Direct link to JWT 的結構">​</a></h2>
<p>在 JSON Web Tokens 的緊湊格式中，它由三個用點（.）分隔的部分組成，這些部分分別是：</p>
<ul>
<li>標頭（Header）</li>
<li>負載（Payload）</li>
<li>簽章（Signature）</li>
</ul>
<p>因此，一個典型的 JWT 的格式會是這樣的：</p>
<p>xxxxx.yyyyy.zzzzz</p>
<p>下面我們來逐一解析這些部分。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="標頭-header">標頭 Header<a href="#標頭-header" class="hash-link" aria-label="Direct link to 標頭 Header" title="Direct link to 標頭 Header">​</a></h3>
<p>標頭部分一般由兩個元素組成：一是 Token 的類型，即「JWT」，二是所採用的簽名算法，例如 HMAC SHA256 或 RSA。</p>
<p>舉個例子：</p>
<div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;alg&quot;: &quot;HS256&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;typ&quot;: &quot;JWT&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>然後，這段 JSON 會經過 Base64Url 編碼，從而形成 JWT 的第一部分。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="負載-payload">負載 Payload<a href="#負載-payload" class="hash-link" aria-label="Direct link to 負載 Payload" title="Direct link to 負載 Payload">​</a></h3>
<p>Token 的第二部分是負載，它包含了多個聲明。聲明是對實體（通常指用戶）及額外資料的陳述。聲明分為三類：<em><strong>註冊聲明</strong></em>、<em><strong>公開聲明</strong></em> 和 <em><strong>私有聲明</strong></em>。</p>
<ul>
<li>註冊聲明(Registered claims)：這些是一組事先定義好的聲明，雖非強制性的，但建議使用，以便提供一套實用且能夠互相操作的聲明。例如：iss（發行者）、exp（過期時間）、sub（主體）、aud（受眾）等。</li>
</ul>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_BuS1"><p>請注意，為了保持 JWT 的緊湊性，這些聲明名稱通常只有三個字母長。</p></div></div>
<ul>
<li>
<p>公開聲明(Public claims)：JWT 的使用者可以自行定義這些聲明。為了避免名稱衝突，這些聲明應在 <a href="https://www.iana.org/assignments/jwt/jwt.xhtml" target="_blank" rel="noopener noreferrer">IANA JSON Web Token Registry</a> 中註冊，或者定義為一個包含防碰撞性命名空間的 URI。</p>
</li>
<li>
<p>私有聲明(Private claims)：這些是用於在同意使用這些聲明的各方之間交換資訊的自訂聲明，它們既不屬於註冊聲明也不屬於公開聲明。</p>
</li>
</ul>
<p>一個負載的例子如下：</p>
<div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;sub&quot;: &quot;1234567890&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;name&quot;: &quot;John Doe&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;admin&quot;: true</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>隨後，這段負載會經過 Base64Url 編碼，形成 JSON Web Token 的第二部分。</p>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_BuS1"><p>要注意的是，對於簽名的 Token 來說，儘管這些資訊受到篡改保護，但任何人都可以閱讀。除非進行加密，否則不要在 JWT 的標頭或有效載荷部分放置機密資訊。</p></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="簽章-signature">簽章 Signature<a href="#簽章-signature" class="hash-link" aria-label="Direct link to 簽章 Signature" title="Direct link to 簽章 Signature">​</a></h3>
<p>要製作簽名部分，你需要取得已編碼的標頭和負載、一個秘密鑰匙，以及標頭中指定的算法，並基於這些進行簽名。</p>
<p>比如說，如果你選擇使用 HMAC SHA256 算法，簽名將按照以下方式生成：</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">HMACSHA256(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  base64UrlEncode(header) + &quot;.&quot; +</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  base64UrlEncode(payload),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  secret)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>簽名的作用是確保信息在傳輸過程中未被篡改，並且在使用私鑰進行簽名的 Token 中，還能驗證 JWT 發送者的真實身份。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="綜合這些元素">綜合這些元素<a href="#綜合這些元素" class="hash-link" aria-label="Direct link to 綜合這些元素" title="Direct link to 綜合這些元素">​</a></h3>
<p>生成的結果是三段用點分隔的 Base64-URL 字串，這種格式便於在 HTML 和 HTTP 環境中傳遞，且相比基於 XML 的標準（如 SAML）更為緊湊。</p>
<p>以下是一個例子，展示了一個包含上述標頭和有效負載編碼，並用秘密簽名的 JWT。這是編碼後的 JWT。</p>
<p><img loading="lazy" alt="jwt-001" src="/src.dev/assets/images/jwt-001-eead6a042010143c98bec97392f08b7d.png" width="1562" height="360" class="img_ev3q"></p>
<p>如果你想親自實驗 JWT 並將這些概念應用於實踐，可以使用 <a href="https://jwt.io/#debugger-io" target="_blank" rel="noopener noreferrer">jwt.io Debugger</a> 來解碼、驗證和生成 JWT。</p>
<p><img loading="lazy" alt="jwt-002" src="/src.dev/assets/images/jwt-002-fa40ca9e79e1732eb8f95b8d918abb32.png" width="959" height="1079" class="img_ev3q"></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="json-web-tokens-的運作方式是什麼">JSON Web Tokens 的運作方式是什麼？<a href="#json-web-tokens-的運作  方式是什麼" class="hash-link" aria-label="Direct link to JSON Web Tokens 的運作方式是什麼？" title="Direct link to JSON Web Tokens 的運作方式是什麼？">​</a></h2>
<p>在使用者透過帳號密碼成功登入後，系統會回傳一個 JSON Web Token 作為身份驗證的憑據。由於這些令牌涉及安全性，因此必須嚴格管理，避免任何安全隱患。通常情況下，不建議將令牌保存時間過長。</p>
<p>此外，考慮到安全性問題，敏感的會話資料不應儲存在瀏覽器存儲中。</p>
<p>當用戶需要進入受保護的路徑或資源時，應透過用戶端代理發送 JWT，通常這是透過在 Authorization header 中附加 Bearer 格式來完成。其格式如下：</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Authorization: Bearer &lt;token&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>在特定情況下，這種方法可實現無狀態授權。當伺服器偵測到 Authorization header 中有有效的 JWT 時，將允許用戶訪問受保護的資源。倘若 JWT 中已包含所需資料，則有可能減少對資料庫的查詢需 求，但這不是絕對的。</p>
<p>要注意的是，透過 HTTP header 傳送 JWT 時，最好避免令牌過大。有些伺服器對頭部資料的接受限制為 8 KB。如果令牌中包含過多資訊，例如包含用戶所有權限資料，則可能需要尋找其他解決方案，例如使用 Auth0 的細粒度授權。</p>
<p>若 JWT 是透過 Authorization header 發送，則不會引起跨來源資源共享（CORS）的問題，因為它不依賴 cookies。</p>
<p>以下示意圖展示了如何獲取並利用 JWT 存取 API 或其他資源：</p>
<p><img loading="lazy" alt="jwt-003" src="/src.dev/assets/images/jwt-003-a0ea64dd04164ede4422e46564bc9478.png" width="1500" height="571" class="img_ev3q"></p>
<ol>
<li>客戶端或應用程式需要向授權伺服器申請授權，這通常是透過數種不同的授權流程來完成的。舉例來說，一個遵循 OpenID Connect 標準的典型網路應用程式會透過 /oauth/authorize 這個端點，採用授權碼流程進行授權。</li>
<li>一旦授權成功，授權伺服器會回傳一個存取令牌給應用程式。</li>
<li>接著，應用程式利用這個存取令牌來訪問受保護的資源，例如 API。</li>
</ol>
<p>要特別留意的是，對於已經簽名的令牌，其內含的所有信息都是對使用者或其他相關方公開的，儘管他們無法修改這些信息。因此，切勿在令牌中儲存任何機密資料。</p>
<p>如何運作 JSON Web Token</p>
<p>客戶端或應用程序向授權伺服器請求授權，這通常透過不同的授權流程來實現。比如，一個遵循 OpenID Connect 的 Web 應用會透過 /oauth/authorize 端點，使用授權代碼流程來進行。
授權成功後，授權伺服器會將存取令牌發送給應用程序。
應用程序則利用這個存取令牌來存取受保護的資源，如 API。
值得注意的是，即使使用了簽名的令牌，令牌內的所有資訊對於使用者或第三方都是可見的，雖然他們無法更改這些資訊。因此，不應該在 令牌中存放任何秘密資訊。</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="為何我們應該用-json-web-tokens">為何我們應該用 JSON Web Tokens?<a href="#為何我們應該用-json-web-tokens" class="hash-link" aria-label="Direct link to 為何我們應該用 JSON Web Tokens?" title="Direct link to 為何我們應該用 JSON Web Tokens?">​</a></h2>
<p>為什麼選擇 JSON Web Tokens (JWT) 呢？讓我們來探討一下，與 Simple Web Tokens (SWT) 和 Security Assertion Markup Language Tokens (SAML) 相比，JWT 的優勢所在。</p>
<p>首先，JSON 的結構比 XML 更為精簡，所以當它被編碼後，其大小也相對較小，這使得 JWT 在 HTML 和 HTTP 環境下傳輸時更為高效。</p>
<p>從安全角度來看，SWT 只能透過 HMAC 算法使用共享秘鑰進行對稱加密。相比之下，JWT 和 SAML 則可以採用公/私鑰對，並使用 X.509 證書進行簽名。相較於 JSON，要在 XML 上實現數位簽名且不引入安全隱患相對困難得多。</p>
<p>此外，多數程式語言都支援 JSON 解析，因為它們可以直接與對象進行映射。而 XML 則缺乏直觀的文檔對象映射，這使得 JWT 的處理比 SAML 斷言來得簡便。</p>
<p>在實際應用方面，JWT 已經被廣泛應用於互聯網規模的場景，尤其在多平台客戶端處理上，特別是在移動設備上，展現了其便利性。</p>
<p>參考：<a href="https://jwt.io/introduction" target="_blank" rel="noopener noreferrer">Introduction to JSON Web Tokens</a></p></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/src.dev/kotlin/coroutines/coroutines-basic"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Coroutines Basics</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/src.dev/session-and-cookie"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Session 跟 Cookie</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#什麼是-json-web-token" class="table-of-contents__link toc-highlight">什麼是 JSON Web Token?</a></li><li><a href="#你在何時需要使用-jwt" class="table-of-contents__link toc-highlight">你在何時需要使用 JWT?</a></li><li><a href="#jwt-的結構" class="table-of-contents__link toc-highlight">JWT 的結構</a><ul><li><a href="#標頭-header" class="table-of-contents__link toc-highlight">標頭 Header</a></li><li><a href="#負載-payload" class="table-of-contents__link toc-highlight">負載 Payload</a></li><li><a href="#簽章-signature" class="table-of-contents__link toc-highlight">簽章 Signature</a></li><li><a href="#綜合這些元素" class="table-of-contents__link toc-highlight">綜合這些元素</a></li></ul></li><li><a href="#json-web-tokens-的運作方式是什麼" class="table-of-contents__link toc-highlight">JSON Web Tokens 的運作方式是什麼？</a></li><li><a href="#為何我們應該用-json-web-tokens" class="table-of-contents__link toc-highlight">為何我們應該用 JSON Web Tokens?</a></li></ul></div></div></div></div></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2024 src.dev. Built with Docusaurus.</div></div></div></footer></div>
</body>
</html>